package com.example.analyzemate.Controllers.Candle;

import com.example.analyzemate.Models.StockCandleData;
import com.fasterxml.jackson.databind.ObjectMapper;

import java.io.IOException;

/**
 * Класс для парсинга из json в StockCandleData
 */
public class ParseJsonToStockCandleData {
    /**
     * Парсинг из json в StockCandleData
     * @param json - строка json
     * @return StockCandleData
     * @throws IOException - ошибка чтения
     */
    public static StockCandleData JsonToCandleData(String json) throws IOException {

        ObjectMapper objectMapper = new ObjectMapper();
        String json1 = "{\"figi\": \"TCS009029540\", \"TICKER\": \"SBER\", \"timeframe\": \"CANDLE_INTERVAL_DAY\", \"history\": [[\"time\", \"open\", \"close\", \"high\", \"low\", \"volume\"], [1688947200000, 251.0, 247.99, 251.0, 245.78, 138], [1689033600000, 251.64, 248.9, 251.64, 246.06, 162], [1689120000000, 249.0, 251.01, 251.01, 246.94, 71], [1689206400000, 249.98, 251.8, 251.8, 243.57, 93], [1689292800000, 243.72, 247.99, 248.78, 243.72, 107], [1689552000000, 246.0, 244.16, 246.0, 243.51, 95], [1689638400000, 247.0, 247.0, 247.35, 243.61, 83], [1689724800000, 247.01, 246.03, 248.29, 245.24, 54], [1689811200000, 247.49, 243.9, 247.49, 243.43, 62], [1689897600000, 240.34, 244.59, 246.81, 240.34, 141], [1690156800000, 244.6, 242.08, 245.88, 242.05, 129], [1690243200000, 245.89, 246.14, 250.66, 243.05, 134], [1690329600000, 248.0, 246.01, 248.0, 243.57, 128], [1690416000000, 249.99, 247.05, 249.99, 247.05, 86], [1690502400000, 247.89, 249.0, 249.0, 246.79, 111], [1690761600000, 252.44, 266.24, 266.24, 252.44, 223], [1690848000000, 251.54, 268.68, 274.99, 251.54, 324], [1690934400000, 269.36, 268.8, 269.36, 265.84, 128], [1691020800000, 261.0, 267.25, 270.55, 261.0, 140], [1691107200000, 267.28, 262.76, 282.97, 262.74, 218], [1691366400000, 260.56, 262.9, 269.96, 258.01, 115], [1691452800000, 262.99, 264.93, 264.93, 256.54, 136], [1691539200000, 264.0, 257.03, 268.98, 257.03, 103], [1691625600000, 270.0, 266.56, 270.0, 260.77, 82], [1691712000000, 270.0, 267.0, 270.0, 264.37, 67], [1691971200000, 264.42, 269.37, 269.98, 256.55, 121], [1692057600000, 263.0, 262.47, 265.98, 257.09, 57], [1692144000000, 257.16, 259.97, 266.99, 254.23, 73], [1692230400000, 258.0, 258.0, 260.23, 251.01, 83], [1692316800000, 248.1, 257.76, 261.94, 248.1, 93], [1692576000000, 261.96, 260.79, 262.69, 258.54, 82], [1692662400000, 258.52, 259.42, 260.97, 258.51, 79], [1692748800000, 254.63, 257.36, 261.5, 254.63, 81], [1692835200000, 258.5, 254.88, 261.42, 254.88, 63], [1692921600000, 255.08, 261.0, 261.48, 255.08, 35], [1693180800000, 261.5, 264.05, 267.14, 259.96, 128], [1693267200000, 265.01, 266.78, 267.14, 264.0, 79], [1693353600000, 259.28, 269.97, 269.97, 259.28, 153], [1693440000000, 264.04, 266.84, 266.84, 264.04, 109], [1693526400000, 264.54, 263.26, 265.99, 263.23, 79], [1693785600000, 266.49, 267.98, 268.89, 260.89, 116], [1693872000000, 266.36, 262.22, 269.51, 262.05, 99], [1693958400000, 267.97, 263.72, 267.97, 260.26, 46], [1694044800000, 263.73, 256.02, 265.97, 251.44, 75], [1694131200000, 260.38, 256.3, 263.68, 252.68, 89], [1694390400000, 258.0, 255.07, 258.0, 253.35, 61], [1694476800000, 257.6, 258.09, 264.61, 252.25, 107], [1694563200000, 263.7, 259.0, 263.7, 252.47, 153], [1694649600000, 285.63, 259.91, 285.63, 252.55, 63], [1694736000000, 260.5, 261.63, 265.84, 256.43, 65], [1694995200000, 266.52, 260.99, 266.52, 258.04, 90], [1695081600000, 259.5, 261.62, 261.84, 250.0, 83], [1695168000000, 253.0, 254.01, 255.86, 248.06, 78], [1695254400000, 253.5, 251.0, 263.27, 248.26, 77], [1695340800000, 252.98, 261.71, 261.95, 250.01, 45], [1695600000000, 251.64, 252.5, 252.53, 248.59, 66], [1695686400000, 251.46, 254.7, 260.0, 249.2, 85], [1695772800000, 257.5, 244.91, 257.96, 244.91, 65], [1695859200000, 256.27, 257.88, 259.27, 253.28, 71], [1695945600000, 256.02, 260.55, 262.67, 256.02, 65], [1696204800000, 262.69, 260.95, 264.12, 258.25, 86], [1696291200000, 259.5, 260.0, 261.74, 254.46, 73], [1696377600000, 255.01, 260.77, 261.97, 255.01, 46], [1696464000000, 260.77, 259.01, 263.59, 258.87, 27], [1696550400000, 257.34, 263.0, 263.0, 257.34, 45], [1696809600000, 265.0, 266.06, 266.06, 258.8, 83], [1696896000000, 266.0, 263.7, 266.0, 259.67, 65], [1696982400000, 260.5, 260.3, 268.39, 260.3, 92], [1697068800000, 268.66, 259.04, 268.66, 256.09, 83], [1697155200000, 268.93, 266.06, 268.93, 259.28, 39], [1697414400000, 266.06, 268.01, 270.0, 260.09, 27], [1697500800000, 273.95, 270.57, 273.95, 265.84, 43], [1697587200000, 274.59, 268.15, 274.59, 264.48, 122], [1697673600000, 265.07, 268.03, 274.44, 265.07, 173], [1697760000000, 262.0, 268.8, 269.94, 262.0, 98], [1698019200000, 272.01, 265.82, 274.6, 265.74, 90], [1698105600000, 271.72, 270.85, 271.72, 265.99, 106], [1698192000000, 272.0, 274.79, 274.79, 270.0, 76], [1698278400000, 274.79, 269.76, 277.78, 267.68, 147], [1698364800000, 269.0, 267.02, 272.01, 266.18, 127], [1698624000000, 267.56, 273.08, 273.83, 266.24, 90], [1698710400000, 268.91, 268.5, 270.59, 267.12, 68], [1698796800000, 269.0, 270.66, 270.94, 267.22, 68], [1698883200000, 267.02, 268.03, 270.09, 267.02, 38], [1698969600000, 270.99, 269.39, 270.99, 266.56, 67], [1699228800000, 268.6, 271.05, 271.89, 265.63, 9], [1699315200000, 269.72, 278.84, 278.84, 269.72, 88], [1699401600000, 274.96, 277.69, 278.04, 270.06, 128], [1699488000000, 277.01, 276.26, 278.99, 276.01, 97], [1699574400000, 278.99, 281.49, 281.49, 276.54, 100], [1699833600000, 277.93, 283.42, 285.48, 277.92, 110], [1699920000000, 283.59, 280.0, 285.47, 278.57, 134], [1700006400000, 282.0, 282.91, 284.99, 278.71, 54], [1700092800000, 281.22, 280.0, 284.76, 280.0, 98], [1700179200000, 274.0, 282.05, 282.06, 274.0, 99], [1700438400000, 285.52, 280.09, 288.22, 279.0, 61], [1700524800000, 282.03, 284.81, 286.99, 281.02, 102], [1700611200000, 287.73, 281.12, 287.73, 280.92, 67], [1700697600000, 284.79, 285.26, 287.8, 284.79, 79], [1700784000000, 287.5, 291.13, 291.13, 285.09, 89], [1701043200000, 282.31, 283.72, 288.57, 272.08, 175], [1701129600000, 286.77, 280.87, 286.77, 277.72, 59], [1701216000000, 290.86, 277.61, 290.86, 275.02, 119], [1701302400000, 276.99, 275.73, 277.79, 272.32, 37], [1701388800000, 273.41, 273.62, 280.98, 273.4, 57], [1701648000000, 277.95, 266.84, 280.95, 266.84, 111], [1701734400000, 281.15, 275.4, 281.15, 269.1, 65], [1701820800000, 279.88, 265.0, 279.88, 265.0, 120], [1701907200000, 268.25, 263.32, 268.25, 262.12, 59], [1701993600000, 266.7, 267.89, 268.39, 263.3, 55], [1702252800000, 255.02, 259.95, 268.83, 255.02, 116], [1702339200000, 256.06, 258.0, 262.99, 255.05, 112], [1702425600000, 259.99, 260.44, 260.44, 256.99, 93], [1702512000000, 264.5, 258.28, 264.5, 255.61, 63], [1702598400000, 263.78, 268.0, 268.0, 257.06, 85], [1702857600000, 268.95, 267.03, 270.49, 265.95, 73], [1702944000000, 269.72, 265.04, 269.72, 265.04, 91], [1703030400000, 274.74, 269.99, 274.74, 266.01, 45], [1703116800000, 274.75, 268.35, 274.75, 263.27, 36], [1703203200000, 266.74, 274.77, 274.77, 265.04, 107], [1703462400000, 274.72, 270.51, 274.77, 269.51, 73], [1703548800000, 271.26, 274.77, 274.77, 269.3, 73], [1703635200000, 270.96, 271.01, 273.49, 270.1, 70], [1703721600000, 272.29, 272.3, 272.3, 267.38, 54], [1703808000000, 272.0, 272.41, 272.41, 268.52, 78], [1704240000000, 274.97, 277.0, 277.0, 271.97, 28], [1704326400000, 276.99, 275.49, 276.99, 270.0, 19], [1704412800000, 274.69, 271.95, 274.69, 271.95, 10], [1704672000000, 275.85, 274.17, 276.0, 274.17, 18], [1704758400000, 273.02, 274.6, 278.99, 273.02, 150], [1704844800000, 275.5, 274.5, 276.99, 273.95, 122], [1704931200000, 274.34, 274.13, 279.93, 274.13, 58], [1705017600000, 277.5, 274.64, 277.5, 274.55, 64], [1705276800000, 281.31, 275.01, 281.31, 272.91, 96], [1705363200000, 272.97, 275.99, 280.0, 272.96, 72], [1705449600000, 276.05, 277.04, 279.95, 275.36, 96], [1705536000000, 275.8, 278.46, 279.99, 275.8, 99], [1705622400000, 277.64, 276.49, 277.64, 273.46, 76], [1705881600000, 280.0, 275.5, 284.83, 269.92, 48], [1705968000000, 283.61, 276.31, 283.62, 275.01, 39], [1706054400000, 276.31, 275.0, 276.31, 272.12, 99], [1706140800000, 274.97, 274.07, 274.99, 271.88, 55], [1706227200000, 274.52, 274.5, 274.52, 271.19, 68], [1706486400000, 272.3, 274.97, 275.0, 272.3, 72], [1706572800000, 274.98, 274.5, 276.89, 272.5, 114], [1706659200000, 277.0, 276.61, 277.99, 274.0, 80], [1706745600000, 276.97, 275.5, 277.69, 274.89, 67], [1706832000000, 278.99, 277.91, 278.99, 274.29, 69], [1707091200000, 283.0, 278.99, 283.0, 276.95, 88], [1707177600000, 284.0, 277.5, 284.59, 276.96, 65], [1707264000000, 277.15, 284.8, 284.8, 277.15, 67], [1707350400000, 285.0, 285.1, 286.0, 281.21, 145], [1707436800000, 283.5, 283.5, 284.99, 278.5, 93], [1707696000000, 282.99, 287.63, 287.63, 282.98, 116], [1707782400000, 289.49, 288.0, 289.49, 285.05, 122], [1707868800000, 291.11, 288.03, 291.11, 286.04, 74], [1707955200000, 289.88, 290.97, 290.97, 287.68, 54], [1708041600000, 291.11, 290.42, 292.0, 286.51, 114], [1708300800000, 291.99, 290.0, 291.99, 286.77, 100], [1708387200000, 287.61, 285.68, 288.39, 285.66, 94], [1708473600000, 284.73, 281.14, 285.6, 279.57, 108], [1708560000000, 282.51, 284.49, 284.49, 282.03, 80], [1708905600000, 282.0, 289.25, 290.96, 282.0, 127], [1708992000000, 291.1, 293.09, 293.1, 289.66, 126], [1709078400000, 293.56, 289.75, 294.59, 289.75, 85], [1709164800000, 294.19, 292.21, 294.19, 291.11, 75], [1709251200000, 294.49, 296.58, 296.58, 290.43, 138], [1709510400000, 296.61, 298.14, 299.98, 293.46, 97], [1709596800000, 299.85, 299.99, 300.0, 296.24, 141], [1709683200000, 299.98, 297.58, 299.98, 295.6, 85], [1709769600000, 298.49, 299.5, 299.5, 297.51, 66], [1710115200000, 300.0, 301.72, 305.95, 298.64, 139], [1710201600000, 297.26, 300.37, 300.37, 297.26, 66], [1710288000000, 299.29, 299.22, 301.45, 298.23, 97], [1710374400000, 295.0, 294.94, 302.05, 294.94, 51], [1710460800000, 298.71, 296.01, 298.71, 296.01, 15]]}";
//        json1 = "{\"figi\": \"TCS009029540\", \"TICKER\": \"SBER\", \"timeframe\": \"CANDLE_INTERVAL_DAY\", \"history\": [[\"time\", \"open\", \"close\", \"high\", \"low\", \"volume\"], [1688947200000, 251.0, 247.99, 251.0, 245.78, 138], [1689033600000, 251.64, 248.9, 251.64, 246.06, 162], [1689120000000, 249.0, 251.01, 251.01, 246.94, 71], [1689206400000, 249.98, 251.8, 251.8, 243.57, 93], [1689292800000, 243.72, 247.99, 248.78, 243.72, 107]]}";
        StockCandleData stockCandleData = objectMapper.readValue(json1, StockCandleData.class);
        stockCandleData.setCandles();
        return stockCandleData;
    }
}
